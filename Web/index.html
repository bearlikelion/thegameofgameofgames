<!doctype html>
<html lang="en" class="h-100">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.0/css/bootstrap.min.css" integrity="sha384-PDle/QlgIONtM1aqA2Qemk5gPOE7wFq8+Em+G/hmo5Iq0CCmYZLv3fVRDJ4MMwEA" crossorigin="anonymous">

    <title>The Game of Game of Games</title>

    <style type="text/css">
        .footer {
          background-color: #f5f5f5;
        }
    </style>
  </head>
  <body class="d-flex flex-column h-100">
    <main role="main" class="flex-shrink-0">
        <div class="container">
            <h1><p class="text-center">The Game of Game of Games</p></h1>

            <hr />

            <div class="row">
                <div class="col">
                    <h4 class="text-center"><p>Play in your browser or download it <a href="https://bearlikelion.itch.io/the-game-of-game-of-games">here</a>!</p></h4>

                    <hr />

                    <p>The Game of Game of Games is my entry into the <a href="https://itch.io/jam/tvgamejam" target="_blank">#TVGameJam</a>. This was a <strong>solo development effort as well as my first game!</strong> It was inspired by the television show, <a href="https://www.nbc.com/ellens-game-of-games" target="_blank">Ellen's Game of Games</a>.</p>

                    <p>The project source is available on <a href="https://github.com/bearlikelion/thegameofgameofgames">GitHub</a></p>

                    <p>The player is prompted to select a category and answer the corresponding questions within a ten second time limit. If they get one answer wrong they fail the category and must choose another.  Three strikes and you're out! There is also a challenge mode that endlessly shuffles categories until the strike limit is reached.</p>

                    <p>The game treats each correct answer as a point and stores the time remaining for every correct answer as the player's speed. Scores are submitted to the <a href="https://arneman.me/thegameofgameofgames/">leaderboard</a> sorted by questions correct and then by speed.</p>

                    <p class="text-muted">Thanks to my wonderful wife Carina for help with design, playtesting, and research</p>
                </div>
            </div>

            <hr />

            <div class="row">
                <div class="col">
                    <h1><p>Leaderboard</p></h1>

                    <table class="table table-hover">
                      <thead>
                        <tr>
                          <th scope="col">Name</th>
                          <th></th>
                          <th class="text-center" scope="col">Correct</th>
                          <th class="text-center" scope="col">Speed</th>
                        </tr>
                      </thead>
                      <tbody id="records_table">
                      </tbody>
                    </table>

                    <div class="loading d-flex justify-content-center">
                        <div class="spinner-border" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer mt-auto py-3">
      <div class="container">
        <div class="row  text-muted">
            <div class="col text-left">
                <span>Made by <a href="https://arneman.me" target="_blank">Mark</a> for the <a href="https://bearlikelion.itch.io/the-game-of-game-of-games">#TVGameJam</a>.</span>
            </div>
            <div class="col text-center">
                <span>Powered by <a href="https://dreamlo.com" target="_blank">Dreamlo.</a></span>
            </div>
            <div class="col text-right">
                <span>Scores from: <span class="timestamp">Fetching Scores...</span></span>
            </div>
        </div>
      </div>
    </footer>
    <img src="https://stats.arneman.me/anal.php?idsite=2&amp;rec=1" style="border:0" alt="" />

    <!-- <script src="https://www.dreamlo.com/lb/5c5dd477b639870c248d3350/js" type="text/javascript"></script> -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.0/js/bootstrap.min.js" integrity="sha384-7aThvCh9TypR7fIc2HV4O/nFMVCBwyIUKL8XCtKE+8xgCgl/PQGuFsvShjr74PBp" crossorigin="anonymous"></script>
    <script type="text/javascript" src="lscache.min.js"></script>
    <script type="text/javascript" src="thenby.min.js"></script>

    <script type="text/javascript">
      var _paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="//stats.arneman.me/";
        _paq.push(['setTrackerUrl', u+'anal.php']);
        _paq.push(['setSiteId', '2']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'anal.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>

    <script type="text/javascript">
        //<![CDATA[
        var owa_baseUrl = 'http://wa.arneman.me/';
        var owa_cmds = owa_cmds || [];
        owa_cmds.push(['setSiteId', '7939fe2c9a05013cdd0f3ac71d6e3f44']);
        owa_cmds.push(['trackPageView']);
        owa_cmds.push(['trackClicks']);

        (function() {
            var _owa = document.createElement('script'); _owa.type = 'text/javascript'; _owa.async = true;
            owa_baseUrl = ('https:' == document.location.protocol ? window.owa_baseSecUrl || owa_baseUrl.replace(/http:/, 'https:') : owa_baseUrl );
            _owa.src = owa_baseUrl + 'modules/base/js/owanal.js';
            var _owa_s = document.getElementsByTagName('script')[0]; _owa_s.parentNode.insertBefore(_owa, _owa_s);
        }());
        //]]>
    </script>

    <script>
        var url = 'https://www.dreamlo.com/lb/5c5dd477b639870c248d3350/json-score-desc';
        lscache.remove(url); // DEBUG

        function ShowScores(score) {
            $( ".loading" ).remove();
            $(".timestamp").text(lscache.get('timestamp'));
            $.each(score, function(i, item) {
                // console.log(item);
                var $tr = $('<tr>').append(
                    $('<td colspan="2">').text(item.text),
                    $('<td class="text-center">').text(item.score),
                    $('<td class="text-center">').text(item.seconds)
                ).appendTo("#records_table");
            });
        }

        if (cachedJson = lscache.get(url)) {
            console.log("Loaded from cache");
            ShowScores(cachedJson);
        } else {
            console.log("Fetch Fresh Scores");
            $.getJSON(url).done(function (data) {
                if (Array.isArray(data.dreamlo.leaderboard.entry)) {
                    scores = data.dreamlo.leaderboard.entry;
                    scores.sort(
                        firstBy(function(v1, v2) { return v2.score - v1.score; })
                        .thenBy(function(v1, v2) { return v2.seconds - v1.seconds; })
                    );

                    console.log(scores);

                    lscache.set(url, scores, 2);
                    lscache.set('timestamp', new Date().toLocaleTimeString(), 2);
                    ShowScores(scores);
                } else {
                    $(".loading").html("<h3>Failed to load High Scores</h3>");
                }
            });
        }
    </script>
  </body>
</html>